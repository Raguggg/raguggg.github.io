const convertApiSecret="vmnAdUH87oFouQF6",uploadArea=document.querySelector("#uploadArea"),workArea=document.querySelector("#workArea"),loadingText=document.querySelector("#loadingText"),fileInput=document.querySelector("#fileInput"),downloadPanel=document.querySelector("#downloadPanel"),toolTipData=document.querySelector(".upload-area__tooltip-data"),resultDownloadLink=document.querySelector("#resultDownload"),resultFileName=document.querySelector("#resultFileName"),destinationFormatBtn=document.querySelectorAll(".select-converter .grid a"),convertAgainBtn=document.querySelector(".convert-again"),documentTypes=["pdf","doc","docx","ppt","pptx","xls","xlsx"];toolTipData.innerHTML=[...documentTypes].join(", ."),workArea.addEventListener("dragover",(function(e){e.preventDefault(),workArea.classList.add("work-area--over")})),workArea.addEventListener("dragleave",(function(e){workArea.classList.remove("work-area--over")})),workArea.addEventListener("drop",(function(e){e.preventDefault(),workArea.classList.remove("work-area--over"),uploadFile(e.dataTransfer.files[0])})),workArea.addEventListener("click",(function(e){workArea.classList.contains("work-area--Uploaded")||fileInput.click()})),fileInput.addEventListener("change",(function(e){uploadFile(e.target.files[0])})),convertAgainBtn.addEventListener("click",(function(e){e.preventDefault(),location.reload()}));for(let e=0;e<destinationFormatBtn.length;e++)destinationFormatBtn[e].addEventListener("click",(function(e){uploadFile(fileInput.files[0],e.target.innerHTML),workArea.classList.remove("work-area--Select-destination")}));function uploadFile(e,t="pdf"){const o=e.name.split(".").pop(),a=e.size;"pdf"==o?(document.getElementById("title").innerHTML="pdf 2 word",t="docx",fileValidate(o,a)?(workArea.classList.add("work-area--Uploaded"),loadingText.style.display="block",convertFile(e,o,t)):location.reload()):fileValidate(o,a)?(document.getElementById("title").innerHTML="xls"==o||"xlsx"==o?"Excel 2 Pdf":"ppt"==o||"pptx"==o?"PPT 2 Pdf":"word 2 pdf",workArea.classList.add("work-area--Uploaded"),loadingText.style.display="grid",convertFile(e,o,t)):location.reload()}function convertFile(e,t,o){let a=ConvertApi.auth({secret:convertApiSecret}),r=a.createParams();r.add("file",e),a.convert(t,o,r).then((e=>{let t=e.dto;t.Files?(loadingText.style.display="none",resultDownloadLink.setAttribute("href",t.Files[0].Url),resultFileName.innerHTML=t.Files[0].FileName,downloadPanel.style.display="block",workArea.classList.add("show-result")):(4010===t.Code?loadingText.innerHTML='Please enter your ConvertAPI secret key in index.js file. You can find the API secret in your <a href="https://www.convertapi.com/a" target="_blank">account dashboard</a>.':loadingText.textContent=`Ooops! ${t.Message}`,loadingText.classList.add("error-message"))}),(e=>{throw e}))}function fileValidate(e,t){return 0!==documentTypes.filter((t=>-1!==e.indexOf(t))).length?t<=5e6||alert("Max file size is 5 MB"):alert(`Please make sure to upload a document. Supported formats are:\r\n.${[...documentTypes].join(", .")}.`)}
